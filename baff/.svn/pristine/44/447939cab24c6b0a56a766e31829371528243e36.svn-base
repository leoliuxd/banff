var util=require('../../../utils/util.js')
var app = getApp()
Page({
    data:{
        seasonName:['春','夏','秋','冬'],
        seasonIndex:0,
        selectedSeason:[
            // {
            //     id:'winter',
            //     name:'冬季庆节',
            //     text:'第92届班夫冬季庆典(Banff Winter Festival)在1月份的最后一周举行，冬趣将持续六天。参加越野滑雪环路赛或纸板雪橇公开赛，甚至还有铁厨(Iron Chef)烹饪比赛和著名的拼字游戏(Spelling Bee)!',
            //     img:'../../../image/winterFestival.png',
            //     open:false
            // }  ,
        ],
        season:[],
    },

    //初始化
    onLoad: function () {
        var selectedSeason
        console.log('onLoad')
        selectedSeason=this.initSeason()
        this.setData({
            selectedSeason:selectedSeason
        })
    },

    //转换季节
    seasonChange: function(e) {
        var selectedSeason
        console.log('选取季节，picker发送选择改变，携带值为', e.detail.value)
        selectedSeason=this.selectSeason(e.detail.value)
        //console.log(selectedSeason)
        this.setData({
            seasonIndex:e.detail.value,
            selectedSeason:selectedSeason
        })
    },

    kindToggle: function (e) {
        var id = e.currentTarget.id, selectedSeason = this.data.selectedSeason;
        console.log('kindToggle')
        for (var i = 0, len = selectedSeason.length; i < len; ++i) {
            if (selectedSeason[i].id == id) {
                selectedSeason[i].open = !selectedSeason[i].open
                selectedSeason[i].unfoldColor=(selectedSeason[i].unfoldColor==='green')?'red':'green'
            }else {
                selectedSeason[i].open = false
                selectedSeason[i].unfoldColor='green'
            }
        console.log(selectedSeason)

        }
        this.setData({
            selectedSeason: selectedSeason,
        });
        
    },

    //获取季节数据
    getSeason: function(){
    var season = util.getSeason()
    console.log("获取季节数据")
    this.setData({
      season:season
    });
  },

  //初始化selectedSeason
  initSeason:function(){
    var selectedSeason
    this.getSeason()
    selectedSeason=this.data.season.spring

    for(var index in selectedSeason){
        selectedSeason[index].seasonDay='spring'
        selectedSeason[index].open=false
        selectedSeason[index].unfoldColor='green'
    }
    return selectedSeason
  },
  //选取季节
  selectSeason:function(value){
    var value=parseInt(value)
    var selectedSeason
    var _season=['spring','summer','autumn','winter']
    selectedSeason=this.data.season[_season[value]]

    for(var index in selectedSeason){
        selectedSeason[index].seasonDay=_season[value]
        selectedSeason[index].open=false
        selectedSeason[index].unfoldColor='green'
    } 
    return selectedSeason
  }

})